\newcommand{\andspace}[1]{\hspace{#1}\textrm{and}\hspace{#1}}

\numberwithin{equation}{section}
\setlength{\columnsep}{.5cm}
\setlength{\columnseprule}{1pt}
\def\columnseprulecolor{\color{black}}

\newcommand{\abs}[1]{\left| #1 \right|}
\newcommand{\inner}[1]{\langle #1 \rangle}
\newcommand{\norm}[1]{\left\lVert#1\right\rVert}
\newcommand{\spanvect}{\textnormal{span}}
\newcommand{\union}{\cup}
\newcommand{\Union}{\bigcup}

% Defines a keyword which will bold and add a word to the index.
\newcommand{\keyword}[1]{\textbf{#1}\index{#1}}

% Create a section without making the section title.
\newcommand\invisiblesection[1]{%
	\refstepcounter{section}%
	\addcontentsline{toc}{section}{\protect\numberline{\thesection}#1}%
	\sectionmark{#1}}

% Makes a chapter with no title
\makeatletter
\newcommand{\unchapter}[1]{%
	\begingroup
	\let\@makechapterhead\@gobble % make \@makechapterhead do nothing
	\chapter{#1}
	\endgroup
}
\makeatother

%%% These are some shortcuts that are handy
\def\real{{\mathbb R}}
\def\Natural{\mathbb{N}}
\def\dx{\textnormal{dx}}
\def\dy{\textnormal{dy}}
\def\dz{\textnormal{dz}}
\def\dt{\textnormal{dt}}
\def\ds{\textnormal{ds}}
\def\dw{\textnormal{dw}}
\def\Re{\textnormal{Re}}
\def\Im{\textnormal{Im}}
\def\exp{\textnormal{exp}}
\def\interior{\textnormal{interior}}
\def\al{\alpha}
\def\del{\delta}
\def\Del{\Delta}
\def\gam{\gamma}
\def\Gam{\Gamma}
\def\Om{\Omega}
\def\ep{\varepsilon}
\def\lam{\lambda}
\def\rational{{\mathbb Q}}
\def\integer{{\mathbb Z}}
\def\Q{{\mathbb Q}}
\def\Z{{\mathbb Z}}
\def\N{{\mathbb N}}
\def\R{{\mathbb R}}
\def\grad{\nabla}
\def\C{\mathcal C}
\def\P{\mathcal P}
\def\T{\mathcal T}
\def\I{\mathcal I}
\def\intersect{\cap}
\def\Intersect{\bigcap}


%%% This defines the solution environment for you to write your solutions
\newenvironment{soln}
{\let\oldqedsymbol=\qedsymbol
	\renewcommand{\qedsymbol}{$ $}
	\begin{proof}[\bfseries\upshape \color{blue}Derivation]\color{blue}}
	{\end{proof}
	\renewcommand{\qedsymbol}{\oldqedsymbol}}

\newenvironment{note}
{\let\oldqedsymbol=\qedsymbol
	\renewcommand{\qedsymbol}{$ $}
	\begin{proof}[\bfseries\upshape \color{red}Note]\color{red}}
	{\end{proof}
	\renewcommand{\qedsymbol}{\oldqedsymbol}}
	

\newenvironment{Deletion}
{\let\oldqedsymbol=\qedsymbol
	\renewcommand{\qedsymbol}{$ $}
	\begin{proof}[\bfseries\upshape \color{red}Deletion]\color{red}}
	{\end{proof}
	\renewcommand{\qedsymbol}{\oldqedsymbol}}


%theorem
\newcounter{theo}[section]
\setcounter{theo}{0}
\renewcommand{\thetheo}{\arabic{chapter}.\arabic{section}.\arabic{theo}}

\definecolor{mytheobgcolor}{RGB}{235, 247, 255} % Light blue background
\definecolor{mytheobordercolor}{RGB}{92, 162, 204} 

\newenvironment{theo}[2][]{
	\refstepcounter{theo}%
	\ifstrempty{#1}{%
		\mdfsetup{%
			frametitle={%
				\tikz[baseline=(current bounding box.east),outer sep=0pt]
				\node[anchor=east,rectangle,fill=mytheobordercolor]
				{\strut Theorem~\thetheo};}
		}
	}{%
		\mdfsetup{%
			frametitle={%
				\tikz[baseline=(current bounding box.east),outer sep=1pt]
				\node[anchor=east,rectangle,fill=mytheobordercolor]
				{\strut Theorem~\thetheo:~#1};}
		}
	}%
	\mdfsetup{%
		innertopmargin=10pt,
		linecolor=mytheobordercolor,
		linewidth=2pt,
		topline=true,
		frametitleaboveskip=\dimexpr-\ht\strutbox\relax
	}
	\begin{mdframed}[backgroundcolor=mytheobgcolor]\relax%
		\label{#2}
	}{
	\end{mdframed}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%Lemma
\newcounter{lemm}[section]
\setcounter{lemm}{0}
\renewcommand{\thelemm}{\arabic{chapter}.\arabic{section}.\arabic{lemm}}

% Customize the colors here
\definecolor{mylemmbgcolor}{RGB}{235, 255, 235}  % Light green background
\definecolor{mylemmbordercolor}{RGB}{112, 173, 112}  % Slightly lighter green border

\newenvironment{lemm}[2][]{
	\refstepcounter{lemm}%
	\ifstrempty{#1}{%
		\mdfsetup{%
			frametitle={%
				\tikz[baseline=(current bounding box.east),outer sep=0pt]
				\node[anchor=east,rectangle,fill=mylemmbordercolor]
				{\strut Lemma~\thelemm};}
		}
	}{%
		\mdfsetup{%
			frametitle={%
				\tikz[baseline=(current bounding box.east),outer sep=1pt]
				\node[anchor=east,rectangle,fill=mylemmbordercolor]
				{\strut Lemma~\thelemm:~#1};}
		}
	}%
	\mdfsetup{%
		innertopmargin=10pt,
		linecolor=mylemmbordercolor,
		linewidth=2pt,
		topline=true,
		frametitleaboveskip=\dimexpr-\ht\strutbox\relax
	}
	\begin{mdframed}[backgroundcolor=mylemmbgcolor]\relax%
		\label{#2}
	}{
	\end{mdframed}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%Proof
\newcounter{prf}[section]\setcounter{prf}{0}
\renewcommand{\theprf}{\arabic{chapter}.\arabic{section}.\arabic{prf}}
\newenvironment{prf}[2][]{%
	\refstepcounter{prf}%
	\ifstrempty{#1}%
	{\mdfsetup{%
			frametitle={%
				\tikz[baseline=(current bounding box.east),outer sep=0pt]
				\node[anchor=east,rectangle,fill=red!20]
				{\strut Proof~\theprf};}}
	}%
	{\mdfsetup{%
			frametitle={%
				\tikz[baseline=(current bounding box.east),outer sep=0pt]
				\node[anchor=east,rectangle,fill=red!20]
				{\strut Proof~\theprf:~#1};}}%
	}%
	\mdfsetup{innertopmargin=10pt,linecolor=red!20,%
		linewidth=2pt,topline=true,%
		frametitleaboveskip=\dimexpr-\ht\strutbox\relax
	}
	\begin{mdframed}[]\relax%
		\label{#2}}{\qed\end{mdframed}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%Definition
\definecolor{mygray}{RGB}{240,240,240}
\definecolor{mybordergray}{RGB}{200,200,200}

\newcounter{defn}[section]
\setcounter{defn}{0}
\renewcommand{\thedefn}{\arabic{chapter}.\arabic{section}.\arabic{defn}}

\newenvironment{defn}[2][]{
	\refstepcounter{defn}
	\ifstrempty{#1}{
		\mdfsetup{
			frametitle={
				\tikz[baseline=(current bounding box.east),outer sep=0pt]
				\node[anchor=east,rectangle,fill=mybordergray]
				{\strut Definition~\thedefn};
			}
		}
	}{
		\mdfsetup{
			frametitle={
				\tikz[baseline=(current bounding box.east),outer sep=1pt]
				\node[anchor=east,rectangle,fill=mybordergray]
				{\strut Definition~\thedefn:~#1};
			}
		}
	}
	\mdfsetup{
		innertopmargin=10pt,
		linecolor=mybordergray,
		linewidth=2pt,
		topline=true,
		frametitleaboveskip=\dimexpr-\ht\strutbox\relax,
		backgroundcolor=mygray,
	}
	\begin{mdframed}[nobreak=true]\relax
		\label{#2}
	}{
	\end{mdframed}
}
	
%Fancy Box
\newcounter{fancybox}[section]
\setcounter{fancybox}{0}
\renewcommand{\thefancybox}{\arabic{chapter}.\arabic{section}.\arabic{fancybox}}

% Customize the colors here
\definecolor{myfancyboxbg}{RGB}{255, 235, 205}  % Light orange background
\definecolor{myfancyboxborder}{RGB}{255, 165, 0}  % Orange border

\newenvironment{fancybox}[2][]{%
	\refstepcounter{fancybox}%
	\ifstrempty{#1}{%
		\mdfsetup{%
			frametitle={%
				\tikz[baseline=(current bounding box.east),outer sep=0pt]
				\node[anchor=east,rectangle,fill=myfancyboxborder]
				{\strut ~\thefancybox};}
		}
	}{%
		\mdfsetup{%
			frametitle={%
				\tikz[baseline=(current bounding box.east),outer sep=0pt]
				\node[anchor=east,rectangle,fill=myfancyboxborder]
				{\strut ~\thefancybox:~#1};}
		}
	}%
	\mdfsetup{%
		innertopmargin=10pt,
		linecolor=myfancyboxborder,
		linewidth=2pt,
		topline=true,
		frametitleaboveskip=\dimexpr-\ht\strutbox\relax
	}
	\begin{mdframed}[backgroundcolor=myfancyboxbg]\relax%
		\label{#2}
	}{
	\end{mdframed}
}

% questions

% Define the questions environment
\NewEnviron{questions}{%
	\begin{tcolorbox}[
		colback=orange!10,
		colframe=orange!50,
		arc=0pt,
		boxrule=1pt,
		title={\faQuestion\ Questions},
		fonttitle=\bfseries,
		coltitle=blue!50!black,
		colbacktitle=yellow!20,
		attach title to upper={\par},
		boxsep=0pt,
		]
		\begin{itemize}  % Start the itemize environment
			\BODY  % This will contain the list of questions
		\end{itemize}  % End the itemize environment
	\end{tcolorbox}
}